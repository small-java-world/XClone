---
description: 
globs: backend/src/main/kotlin/com/example/xclone/domain/post/**/*.kt,backend/src/main/kotlin/com/example/xclone/application/post/**/*.kt
alwaysApply: false
---
---
description: 投稿ドメインに関するルール
globs: backend/src/main/kotlin/com/example/xclone/domain/post/**/*.kt,backend/src/main/kotlin/com/example/xclone/application/post/**/*.kt
alwaysApply: false
---
# Post Domain Rules

## エンティティと値オブジェクト
- **Post**: 投稿を表すエンティティ
  - **PostId**: UUID形式の識別子（BINARY(16)で保存）
  - **UserId**: 投稿者のID（外部キー）
  - **Content**: 投稿内容
  - **MediaUrls**: メディアURL配列（オプショナル）
  - **ReplyToId**: 返信先の投稿ID（オプショナル）
  - **CreatedAt**: 作成日時
  - **UpdatedAt**: 更新日時

- **Like**: いいねを表すエンティティ
  - **UserId**: いいねしたユーザーID
  - **PostId**: いいねされた投稿ID
  - **CreatedAt**: いいねした日時

## ビジネスルール
- 投稿内容は最大280文字
- メディアは最大4つまで添付可能
- 削除された投稿への返信は表示されるが、元の投稿内容は表示されない
- 自分の投稿のみ削除可能
- いいねは同じ投稿に対して1ユーザー1回まで
- いいねは取り消し可能

## ユースケース
- **CreatePostUseCase**: 新規投稿作成
- **GetPostUseCase**: 投稿取得
- **DeletePostUseCase**: 投稿削除
- **ReplyToPostUseCase**: 投稿への返信
- **LikePostUseCase**: 投稿にいいね
- **UnlikePostUseCase**: いいね取り消し
- **GetUserPostsUseCase**: ユーザーの投稿一覧取得
- **GetPostRepliesUseCase**: 投稿への返信一覧取得

## API エンドポイント
- **POST /api/posts**: 投稿作成
- **GET /api/posts/{id}**: 投稿取得
- **DELETE /api/posts/{id}**: 投稿削除
- **POST /api/posts/{id}/replies**: 投稿への返信
- **GET /api/posts/{id}/replies**: 投稿への返信一覧取得
- **POST /api/posts/{id}/likes**: 投稿にいいね
- **DELETE /api/posts/{id}/likes**: いいね取り消し
- **GET /api/users/{userId}/posts**: ユーザーの投稿一覧取得 