---
description: 
globs: backend/src/main/kotlin/com/example/xclone/domain/media/**/*.kt,backend/src/main/kotlin/com/example/xclone/application/media/**/*.kt
alwaysApply: false
---
---
description: メディアドメインに関するルール
globs: backend/src/main/kotlin/com/example/xclone/domain/media/**/*.kt,backend/src/main/kotlin/com/example/xclone/application/media/**/*.kt
alwaysApply: false
---
# Media Domain Rules

## エンティティと値オブジェクト
- **Media**: メディアを表すエンティティ
  - **MediaId**: メディアの一意識別子
  - **UserId**: アップロードしたユーザーID
  - **Type**: メディアタイプ（画像/動画/GIF）
  - **Url**: メディアのURL
  - **ThumbnailUrl**: サムネイルURL（動画の場合）
  - **Width**: 幅（ピクセル）
  - **Height**: 高さ（ピクセル）
  - **Size**: ファイルサイズ（バイト）
  - **CreatedAt**: アップロード日時

## ビジネスルール
- サポートするメディアタイプ：
  - 画像：JPG, PNG, WebP（最大10MB）
  - 動画：MP4, WebM（最大100MB、最長2分）
  - GIF：アニメーションGIF（最大15MB）
- 画像は自動的にリサイズされる（最大4K解像度）
- 動画は自動的にエンコードされる（最適化）
- 投稿には最大4つのメディアを添付可能
- メディアはS3互換ストレージに保存
- 未使用メディア（投稿に添付されていない）は24時間後に自動削除

## ユースケース
- **UploadMediaUseCase**: メディアアップロード
- **GetMediaUseCase**: メディア取得
- **DeleteMediaUseCase**: メディア削除
- **GetUserMediaUseCase**: ユーザーのメディア一覧取得
- **ProcessMediaUseCase**: メディア処理（リサイズ、エンコード）

## API エンドポイント
- **POST /api/media/upload**: メディアアップロード
- **GET /api/media/{id}**: メディア情報取得
- **DELETE /api/media/{id}**: メディア削除
- **GET /api/users/{userId}/media**: ユーザーのメディア一覧取得 